<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Nested Sampling Demo | Jules Perret</title>
  <meta name="description" content="Interactive visualization of the Nested Sampling algorithm for Bayesian inference" />

  <!-- MathJax for LaTeX rendering -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>

  <link rel="stylesheet" href="css/shared-styles.css">
</head>

<body>

<header class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Jules Perret</a>
    <nav class="site-nav">
      <input type="checkbox" id="nav-trigger" class="nav-trigger" />
      <label for="nav-trigger">
        <span class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
          </svg>
        </span>
      </label>
      <div class="trigger">
         <a class="page-link" href="/about.html">Curriculum Vitae</a>
        <a class="page-link" href="/bayesian_inference.html">Introduction to Bayesian Inference</a>
        <a class="page-link" href="/publications.html">Publications</a>
        <a class="page-link" href="/research.html">Research</a>
      </div>
    </nav>
  </div>
</header>

<main class="page-content" aria-label="Content">
  <div class="wrapper">
    <h1 class="page-heading">Nested Sampling</h1>
    <p class="page-subtitle">
      Interactive visualization of evidence computation and posterior sampling via nested sampling<br>
      <span style="font-size: 0.9rem; color: #718096;">Part 3 of the MCMC Samplers Series | See also: 
      <a href="/mcmc.html" style="color: #667eea;">Metropolis‚ÄìHastings</a> ¬∑ 
      <a href="/hmc.html" style="color: #667eea;">HMC</a></span>
    </p>
  </div>
</main>

<div class="container">

  <!-- INTRODUCTION -->
  <div class="section">
    <h2 class="section-title">Introduction to Nested Sampling</h2>
    <p>
      <strong>Nested Sampling</strong> is a computational approach to Bayesian inference introduced by John Skilling (2004, 2006). 
      Unlike traditional MCMC methods that sample from the posterior distribution, nested sampling is primarily designed 
      to compute the <strong>Bayesian evidence</strong> (marginal likelihood) \(\mathcal{Z}\), with posterior samples 
      obtained as a byproduct.
    </p>
    <p>
      The key innovation is transforming the multi-dimensional integration problem into a one-dimensional problem by 
      evolving samples from regions of low likelihood to high likelihood. This makes nested sampling particularly 
      effective for model comparison and exploring multimodal posteriors.
    </p>
    
    <div class="algorithm-box" style="margin-top: 1.5rem;">
      <strong>Why Nested Sampling?</strong>
      <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
        <li><strong>Evidence computation:</strong> Directly calculates \(\mathcal{Z} = \int \mathcal{L}(\mathbf{\theta}) \pi(\mathbf{\theta}) d\mathbf{\theta}\) for model comparison</li>
        <li><strong>Multimodal posteriors:</strong> Naturally explores multiple modes without mode-hopping difficulties</li>
        <li><strong>No burn-in:</strong> Every point contributes to the evidence calculation; no samples are discarded</li>
        <li><strong>Automatic termination:</strong> Algorithm stops when the remaining evidence contribution is negligible</li>
        <li><strong>Posterior samples:</strong> Importance-weighted samples from the posterior are obtained automatically</li>
      </ul>
    </div>

    <div class="info-note" style="margin-top: 1.5rem;">
      <strong>The Key Insight:</strong> Instead of sampling directly from the posterior \(\pi(\mathbf{\theta}|\mathbf{d})\), 
      nested sampling samples from constrained priors with increasing likelihood thresholds. By tracking the shrinking 
      prior volume at each likelihood level, we can numerically integrate to compute the evidence and generate posterior samples.
    </div>
  </div>

  <!-- ALGORITHM DESCRIPTION -->
  <div class="section">
    <h2 class="section-title">The Nested Sampling Algorithm</h2>
    <p>
      <strong>Nested Sampling</strong> was introduced by Skilling (2004, 2006) for calculating the Bayesian evidence. 
      The algorithm maintains a set of "live points" sampled from the prior, progressively replacing the point 
      with the lowest likelihood while shrinking the prior volume.
    </p>

    <div class="algorithm-box">
      <strong>The Evidence Integral:</strong>
      <p style="margin: 0.75rem 0;">
        Bayes' theorem in terms of evidence:
      </p>
      $$\pi(\mathbf{\theta}|\mathbf{d}) = \frac{\mathcal{L}(\mathbf{\theta})\pi(\mathbf{\theta})}{\mathcal{Z}}$$
      <p style="margin: 0.5rem 0;">
        where the evidence is:
      </p>
      $$\mathcal{Z} = \int \mathcal{L}(\mathbf{\theta}) \pi(\mathbf{\theta}) d\mathbf{\theta}$$
      <p style="margin: 0.75rem 0 0 0;">
        Nested sampling rewrites this integral in terms of prior volume \(X\) enclosed by likelihood contour \(\mathcal{L}\):
      </p>
      $$\mathcal{Z} = \int_0^1 \mathcal{L}(X) dX$$
    </div>
    
    <div class="algorithm-box" style="margin-top: 1.5rem;">
      <strong>Nested Sampling Algorithm:</strong>
      <ol style="margin: 0.5rem 0 0.5rem 0; padding-left: 1.5rem;">
        <li style="margin: 0.75rem 0;">
          <strong>Initialize:</strong> Draw \(N\) live points \(\{\mathbf{\theta}_i\}\) from the prior \(\pi(\mathbf{\theta})\). 
          Set \(X_0 = 1\) (entire prior volume).
        </li>
        <li style="margin: 0.75rem 0;">
          <strong>Iterate:</strong> At iteration \(i\):
          <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
            <li>Find the live point with lowest likelihood: \(\mathcal{L}_i^* = \min_j \mathcal{L}(\mathbf{\theta}_j)\)</li>
            <li>Save this point as a sample: \((\mathbf{\theta}_i^*, \mathcal{L}_i^*, X_i)\)</li>
            <li>Estimate prior volume shrinkage: \(X_i \approx t_i X_{i-1}\) where \(t_i \sim \text{Beta}(N, 1)\)</li>
            <li>Replace the discarded point by sampling from the prior with constraint \(\mathcal{L}(\mathbf{\theta}) > \mathcal{L}_i^*\)</li>
          </ul>
        </li>
        <li style="margin: 0.75rem 0;">
          <strong>Terminate:</strong> Stop when the estimated remaining evidence contribution is negligible 
          (typically when \(\mathcal{L}_{\text{max}} \times X < \epsilon \times \mathcal{Z}_{\text{current}}\))
        </li>
        <li style="margin: 0.75rem 0;">
          <strong>Compute evidence:</strong> Numerical integration via trapezoidal rule:
          $$\mathcal{Z} \approx \sum_{i=1}^{M} \mathcal{L}_i^* \Delta X_i$$
          where \(\Delta X_i = X_{i-1} - X_{i+1}\) (or variants)
        </li>
        <li style="margin: 0.75rem 0;">
          <strong>Extract posterior:</strong> Samples \(\{\mathbf{\theta}_i^*\}\) with importance weights \(w_i = \mathcal{L}_i^* \Delta X_i / \mathcal{Z}\)
        </li>
      </ol>
    </div>

    <div class="info-note" style="margin-top: 1.5rem;">
      <strong>Key Challenge:</strong> Step 2 requires sampling from a constrained prior (the hardest part). 
      This demo uses a simple rejection sampling approach: draw from the prior and reject if \(\mathcal{L} \leq \mathcal{L}_{\text{min}}\). 
      Real implementations use MCMC within nested sampling (e.g., slice sampling, Metropolis) or advanced techniques 
      like MultiNest's ellipsoidal decomposition or dynesty's dynamic nested sampling.
    </div>
  </div>

  <!-- TARGET DISTRIBUTIONS -->
  <div class="section">
    <h2 class="section-title">Target Distributions</h2>
    <p>
      This demonstration provides three target distributions ranging from simple to challenging, 
      illustrating different aspects of MCMC performance:
    </p>
    
    <div style="display: grid; grid-template-columns: 1fr; gap: 1.5rem; margin-top: 1rem;">
      <div class="algorithm-box">
        <strong>Bivariate Gaussian (Default)</strong>
        <p style="margin: 0.5rem 0;">
          A standard correlated 2D Gaussian with correlation coefficient \(\rho = 0.8\):
        </p>
        <div style="overflow-x: auto;">
          $$\pi(x_1, x_2) \propto \exp\left(-\frac{1}{2(1-\rho^2)}(x_1^2 - 2\rho x_1 x_2 + x_2^2)\right)$$
        </div>
        <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: #4a5568;">
          This distribution has elliptical contours aligned with the correlation structure. 
          With strong correlation (\(\rho = 0.8\)), random-walk proposals struggle because they explore 
          axis-by-axis when parameters should move together along the correlation direction.
        </p>
      </div>

      <div class="algorithm-box">
        <strong>Rosenbrock's Banana Distribution</strong>
        <p style="margin: 0.5rem 0;">
          A transformed Gaussian that creates a curved, banana-shaped density (Haario et al., 1999):
        </p>
        <div style="overflow-x: auto;">
          $$\pi(x_1, x_2) \propto \exp\left(-\frac{1}{200}(x_1^2 + 100(x_2 - x_1^2)^2)\right)$$
        </div>
        <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: #4a5568;">
          This distribution is strongly correlated along a curved manifold, making it difficult for 
          random-walk samplers to explore efficiently. The "banana" shape arises from the nonlinear 
          transformation \(x_2 - x_1^2\), creating regions where standard proposals are inefficient.
        </p>
      </div>
      
      <div class="algorithm-box">
        <strong>Neal's Funnel Distribution</strong>
        <p style="margin: 0.5rem 0;">
          A hierarchical model that exhibits strong scale variations (Neal, 2003):
        </p>
        <div style="overflow-x: auto;">
          $$\begin{aligned}
          x_1 &\sim \mathcal{N}(0, 3^2) \\
          x_2 \mid x_1 &\sim \mathcal{N}(0, \exp(x_1)^2)
          \end{aligned}$$
        </div>
        <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: #4a5568;">
          The joint density is \(\pi(x_1, x_2) \propto \exp(-x_1^2/18 - x_2^2/(2e^{2x_1}))\). 
          This creates a "funnel" where the scale of \(x_2\) depends exponentially on \(x_1\), 
          challenging for fixed-width proposals. Common in hierarchical Bayesian models with variance parameters.
        </p>
      </div>
      
      <div class="algorithm-box" style="background: #fef3c7; border-left: 4px solid #f59e0b;">
        <strong>üåü Bimodal Gaussian Mixture (Showcases Nested Sampling!)</strong>
        <p style="margin: 0.5rem 0;">
          Two well-separated Gaussian modes demonstrating multimodal inference:
        </p>
        <div style="overflow-x: auto;">
          $$\pi(\theta_1, \theta_2) = 0.4 \cdot \mathcal{N}((-2,-2), 0.8^2I) + 0.6 \cdot \mathcal{N}((+2,+2), 0.8^2I)$$
        </div>
        <p style="margin: 0.5rem 0 0 0; font-size: 0.85rem; color: #78350f;">
          <strong>Why this matters for nested sampling:</strong> This is where nested sampling truly shines! 
          MCMC methods (MH, HMC) struggle with mode-hopping‚Äîthey often get stuck in one mode and never find the other. 
          Nested sampling naturally explores both modes because it samples from the entire prior and progressively 
          contracts. Watch the posterior weights plot‚Äîyou should see <strong>two peaks</strong>, one for each mode!
        </p>
      </div>
    </div>
    
    <div class="info-note" style="margin-top: 1rem;">
      <strong>Why these distributions?</strong> The Gaussian provides a baseline. The banana and funnel test 
      challenging geometry (from MCMC/HMC demos for comparison). <strong>The bimodal distribution is the star here</strong>‚Äîit 
      demonstrates nested sampling's key advantage: naturally finding and weighing multiple modes without getting trapped. 
      Try running MH or HMC on the bimodal distribution and compare‚Äîthey'll likely only find one mode!
    </div>
  </div>

  <!-- CONTROLS -->
  <div class="section">
    <h2 class="section-title">Simulation Controls</h2>
    <p>
      Nested sampling has one key parameter: the <strong>number of live points</strong> \(N\). More live points 
      improve accuracy but slow down computation. The algorithm automatically terminates when the remaining 
      evidence contribution becomes negligible.
    </p>
    
    <div class="controls-grid">
      <div class="control-group">
        <label>
          Number of Live Points (N)
          <span class="control-value" id="nliveVal">50</span>
        </label>
        <input type="range" min="10" max="200" step="10" value="50" id="nlive">
        <div style="font-size: 0.85rem; color: #4a5568; margin-top: 0.25rem;">
          More points ‚Üí better evidence estimate, but slower. Typically 50-500.
        </div>
      </div>

      <div class="control-group">
        <label>
          Iteration Speed (ms)
          <span class="control-value" id="speedVal">100</span>
        </label>
        <input type="range" min="10" max="500" step="10" value="100" id="speed">
        <div style="font-size: 0.85rem; color: #4a5568; margin-top: 0.25rem;">
          Delay between iterations. Slower helps visualize the progression.
        </div>
      </div>

      <div class="control-group">
        <label>
          Target Distribution
        </label>
        <select id="dist">
          <option value="gaussian">Bivariate Gaussian</option>
          <option value="banana">Rosenbrock's Banana</option>
          <option value="funnel">Neal's Funnel</option>
          <option value="bimodal">Bimodal Mixture (‚òÖ Best for NS!)</option>
        </select>
        <div style="font-size: 0.85rem; color: #4a5568; margin-top: 0.25rem;">
          The bimodal distribution showcases nested sampling's key advantage: naturally finding multiple modes.
        </div>
      </div>
    </div>

    <div class="button-group">
      <button onclick="start()">‚ñ∂ Start Sampling</button>
      <button class="secondary" onclick="singleStep()">‚Üí Single Iteration</button>
      <button class="tertiary" onclick="reset()">‚ü≤ Reset</button>
    </div>

    <div class="info-note" style="margin-top: 1.5rem;">
      <strong>Note on implementation:</strong> This demo uses simple rejection sampling to generate new live points 
      (draw from prior, reject if likelihood too low). Real implementations use MCMC methods (slice sampling, 
      Metropolis) to efficiently sample from the constrained prior, especially important in high dimensions or 
      for complex likelihood contours.
    </div>
  </div>

  <!-- VISUALIZATION -->
  <div class="section">
    <h2 class="section-title">Nested Sampling Visualization</h2>
    <p>
      The main plot shows the joint posterior \(\pi(\theta_1, \theta_2)\) with darker regions indicating higher probability. 
      <span style="color: #3b82f6; font-weight: 600;">Blue points</span> show the current live points (actively sampling), and 
      <span style="color: #dc2626; font-weight: 600;">red points</span> show dead points (discarded) that contribute 
      to the evidence calculation. Watch how live points progressively contract toward higher-likelihood regions.
    </p>
    
    <div class="visualization-grid">
      <!-- Main posterior plot -->
      <div class="canvas-container">
        <div class="canvas-label">Joint Posterior Distribution œÄ(Œ∏‚ÇÅ, Œ∏‚ÇÇ)</div>
        <canvas id="posterior" width="650" height="650"></canvas>
        <p style="font-size: 0.85rem; color: #4a5568; margin-top: 0.5rem;">
          Live points sample the constrained prior uniformly, naturally exploring all high-density regions 
          (darker areas). For multimodal distributions, you'll see live points in multiple modes simultaneously.
        </p>
      </div>

      <!-- Marginal plots -->
      <div class="marginal-plots">
        <div class="marginal-plot">
          <div class="canvas-label">Marginal Posterior Distribution of Œ∏‚ÇÅ</div>
          <canvas id="histX" width="300" height="280"></canvas>
          <p style="font-size: 0.85rem; color: #4a5568; margin-top: 0.5rem;">
            <strong>Importance-weighted</strong> histogram of Œ∏‚ÇÅ samples. Each dead point contributes 
            proportionally to its posterior weight \(w_i = \mathcal{L}_i \Delta X_i / \mathcal{Z}\). 
            Approximates the true marginal \(\pi(\theta_1 | \text{data})\).
          </p>
        </div>
        <div class="marginal-plot">
          <div class="canvas-label">Marginal Posterior Distribution of Œ∏‚ÇÇ</div>
          <canvas id="histY" width="300" height="280"></canvas>
          <p style="font-size: 0.85rem; color: #4a5568; margin-top: 0.5rem;">
            <strong>Importance-weighted</strong> histogram of Œ∏‚ÇÇ samples. Properly accounts for the fact that 
            different samples contribute differently to the posterior. This is crucial for nested sampling 
            as raw dead points are NOT posterior samples without weighting.
          </p>
        </div>
      </div>
    </div>

    <!-- Current step info -->
    <div class="stats-panel">
      <strong>Current Iteration Details</strong>
      <div id="stepInfo" class="step-info">
        Click "Start Sampling" or "Single Iteration" to begin nested sampling.
      </div>
    </div>
  </div>

  <!-- NESTED SAMPLING DIAGNOSTICS -->
  <div class="section">
    <h2 class="section-title">Nested Sampling Diagnostics</h2>
    <p>
      Unlike MCMC diagnostics (which focus on chain mixing and autocorrelation), nested sampling requires monitoring the <strong>prior volume shrinkage</strong> 
      and <strong>evidence evolution</strong>. These plots show how the algorithm progressively constrains the prior 
      and accumulates evidence.
    </p>
    
    <div class="algorithm-box" style="margin-bottom: 1.5rem;">
      <strong>What to monitor in nested sampling:</strong>
      <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
        <li><strong>Prior volume X(i):</strong> Should shrink exponentially as \(X_i \approx \exp(-i/N)\)</li>
        <li><strong>Log-likelihood evolution:</strong> Should increase as we move to higher-likelihood regions</li>
        <li><strong>Evidence accumulation:</strong> log(Z) should stabilize when most evidence is captured</li>
        <li><strong>Posterior weights:</strong> Show which samples contribute most to the posterior</li>
      </ul>
    </div>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
      <div>
        <div class="canvas-label">Prior Volume Shrinkage: log(X) vs Iteration</div>
        <canvas id="traceX" width="100%" height="250" style="width: 100%;"></canvas>
        <p style="font-size: 0.85rem; color: #4a5568; margin-top: 0.5rem;">
          Prior volume X shrinks exponentially. The slope should be approximately -1/N. 
          Linear on log scale confirms proper shrinkage rate.
        </p>
      </div>
      <div>
        <div class="canvas-label">Log-Likelihood Evolution</div>
        <canvas id="traceY" width="100%" height="250" style="width: 100%;"></canvas>
        <p style="font-size: 0.85rem; color: #4a5568; margin-top: 0.5rem;">
          Minimum log-likelihood at each iteration. Should increase monotonically as we sample 
          from progressively more constrained priors.
        </p>
      </div>
    </div>
    
    <div style="margin-top: 1.5rem;">
      <div class="canvas-label">Evidence Evolution: log(Z) vs Iteration</div>
      <canvas id="evidencePlot" width="100%" height="250" style="width: 100%;"></canvas>
      <p style="font-size: 0.85rem; color: #4a5568; margin-top: 0.5rem;">
        Cumulative log-evidence. Should plateau when remaining prior volume √ó max likelihood becomes negligible.
        The stabilization indicates convergence.
      </p>
    </div>
  </div>

  <!-- DIAGNOSTICS -->
  <div class="section">
    <h2 class="section-title">Posterior Analysis</h2>
    
    <h3 style="font-size: 1.1rem; font-weight: 600; margin: 0 0 1rem 0;">Understanding Posterior Weights</h3>
    <p>
      This is the <strong>most important diagnostic</strong> for nested sampling. It shows you which dead points 
      actually matter for your posterior inference.
    </p>
    
    <div class="algorithm-box" style="margin-bottom: 1.5rem;">
      <strong>The Key Insight:</strong>
      <p style="margin: 0.75rem 0;">
        Each dead point has a posterior weight:
      </p>
      $$w_i = \frac{\mathcal{L}_i \times \Delta X_i}{\mathcal{Z}}$$
      <p style="margin: 0.75rem 0;">
        This weight is the <strong>product of two competing factors</strong>:
      </p>
      <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
        <li>\(\mathcal{L}_i\): Likelihood (how well the parameters fit the data) ‚Äî <strong>increases</strong> with iteration</li>
        <li>\(\Delta X_i\): Prior volume width ‚Äî <strong>decreases</strong> exponentially with iteration</li>
      </ul>
    </div>
    
    <div class="info-note" style="margin-bottom: 1.5rem;">
      <strong>What the plot shows you:</strong>
      <div style="margin-top: 0.75rem; line-height: 1.8;">
        <p style="margin: 0.5rem 0;">
          <strong>üìä Early iterations (left side):</strong><br>
          ‚Ä¢ Large prior volume (\(\Delta X_i\) is big) ‚úì<br>
          ‚Ä¢ BUT low likelihood (\(\mathcal{L}_i\) is small) ‚úó<br>
          ‚Ä¢ <span style="color: #dc2626;">‚Üí Low weights</span> (these points don't contribute much to posterior)
        </p>
        
        <p style="margin: 1rem 0 0.5rem 0;">
          <strong>üéØ Middle iterations (peak of the curve):</strong><br>
          ‚Ä¢ Moderate prior volume (\(\Delta X_i\) still reasonable) ‚úì<br>
          ‚Ä¢ High likelihood (\(\mathcal{L}_i\) is large) ‚úì<br>
          ‚Ä¢ <span style="color: #059669; font-weight: 600;">‚Üí HIGH WEIGHTS ‚Äî These are your most important samples!</span><br>
          ‚Ä¢ These points are near the posterior mode and dominate your inference
        </p>
        
        <p style="margin: 1rem 0 0.5rem 0;">
          <strong>üìâ Late iterations (right side):</strong><br>
          ‚Ä¢ Very high likelihood (\(\mathcal{L}_i\) is huge) ‚úì<br>
          ‚Ä¢ BUT tiny prior volume (\(\Delta X_i \approx 0\)) ‚úó<br>
          ‚Ä¢ <span style="color: #dc2626;">‚Üí Low weights</span> (not much prior volume left to contribute)
        </p>
      </div>
    </div>
    
    <div class="algorithm-box" style="margin-bottom: 1.5rem;">
      <strong>Practical interpretation:</strong>
      <ul style="margin: 0.5rem 0; padding-left: 1.5rem;">
        <li><strong>Sharp, narrow peak:</strong> Posterior is concentrated; only a few iterations matter. 
        May need more live points for accuracy.</li>
        <li><strong>Broad, smooth peak:</strong> Many iterations contribute; good sampling of posterior. 
        ESS will be closer to number of iterations.</li>
        <li><strong>Multiple peaks:</strong> Multimodal posterior! Each peak corresponds to exploring a different mode.</li>
        <li><strong>Peak location:</strong> Shows when you've transitioned from prior-dominated to likelihood-dominated region.</li>
      </ul>
    </div>
    
    <div class="canvas-label">Posterior Weights vs Iteration</div>
    <canvas id="acfXY" width="100%" height="350" style="width: 100%;"></canvas>
    
    <p style="margin-top: 1rem; color: #4a5568; font-size: 0.9rem;">
      <strong>What to look for:</strong> The peak shows the "sweet spot" where nested sampling finds the bulk of the posterior mass. 
      This is where \(\mathcal{L}_i\) is high enough to matter, but \(\Delta X_i\) hasn't shrunk to zero yet. 
      Before the peak, you're exploring low-likelihood regions (prior). After the peak, you're refining details 
      but with negligible volume contribution.
    </p>

    <div style="background: #fef3c7; border-left: 4px solid #f59e0b; padding: 1rem; margin-top: 1rem; border-radius: 4px;">
      <strong style="color: #92400e;">üí° Key takeaway:</strong>
      <p style="margin: 0.5rem 0 0 0; color: #78350f;">
        Unlike MCMC where every sample contributes equally, nested sampling naturally identifies which samples 
        matter most. The posterior weights plot reveals this directly‚Äîyou can literally see which ~10-30% of 
        iterations carry most of the posterior information!
      </p>
    </div>
      hasn't shrunk to negligibility yet. Early iterations (low likelihood) and late iterations 
      (tiny prior volume) both have low weights.
    </p>

    <h3 style="font-size: 1.1rem; font-weight: 600; margin: 2rem 0 1rem 0;">Performance Metrics</h3>
    <div class="stats-grid" style="margin-top: 1rem;">
      <div class="stat-item">
        <div class="stat-label">Iterations</div>
        <div class="stat-value" id="totalIter">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">Log Evidence</div>
        <div class="stat-value" id="acceptRate">‚Äî</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">Dead Points</div>
        <div class="stat-value" id="acceptCount">0</div>
      </div>
      <div class="stat-item">
        <div class="stat-label">Effective Sample Size</div>
        <div class="stat-value" id="essValue">‚Äî</div>
      </div>
    </div>
    
    <div class="algorithm-box" style="margin-top: 1.5rem;">
      <strong>Effective Sample Size for Nested Sampling</strong>
      <p style="margin: 0.75rem 0;">
        In nested sampling, ESS is computed from the <strong>variance of the normalized importance weights</strong>, 
        following standard importance sampling theory (Kish, 1965; Kong, 1992):
      </p>
      $$\text{ESS} = \frac{\left(\sum_{i=1}^{n} w_i\right)^2}{\sum_{i=1}^{n} w_i^2} = \frac{1}{\sum_{i=1}^{n} \tilde{w}_i^2}$$
      <p style="margin: 0.75rem 0 0 0; font-size: 0.9rem;">
        where \(w_i = \mathcal{L}_i \Delta X_i / \mathcal{Z}\) are the normalized posterior weights satisfying \(\sum w_i = 1\), 
        so \(\tilde{w}_i = w_i\). This measures the variance of the weights‚Äîwhen all weights are equal (\(w_i = 1/n\)), 
        we get ESS = \(n\). When weights are highly unequal (few samples dominate), ESS ‚â™ \(n\).
      </p>
      <p style="margin: 0.75rem 0 0 0; font-size: 0.9rem; color: #4a5568;">
        <strong>Interpretation:</strong> ESS quantifies how many equally-weighted samples would provide the same 
        Monte Carlo variance as the weighted sample. This is the standard diagnostic for importance sampling 
        (Liu, 2001; Chopin & Ridgway, 2017) and is reported by nested sampling implementations like dynesty 
        (Speagle, 2020) and NestedFit.
      </p>
    </div>
    
    <div class="info-note" style="margin-top: 1.5rem;">
      <strong>Tuning the Number of Live Points:</strong> The number of live points \(N\) controls the resolution 
      of the prior volume shrinkage. More live points give more accurate evidence estimates and better posterior 
      resolution, but increase computational cost. A practical rule: \(N \gtrsim 25d\) for \(d\) dimensions 
      (Skilling, 2006). For multimodal problems, increase \(N\) to ensure adequate sampling of each mode. 
      Advanced implementations like MultiNest use ellipsoidal decomposition to adaptively allocate live points 
      across modes.
    </div>
  </div>

  <!-- STRENGTHS AND LIMITATIONS -->
  <div class="section">
    <h2 class="section-title">Strengths & Limitations of Nested Sampling</h2>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1rem;">
      <div class="algorithm-box">
        <strong style="color: #059669;">‚úì Strengths</strong>
        <ul style="margin: 0.75rem 0 0 0; padding-left: 1.5rem;">
          <li style="margin: 0.5rem 0;"><strong>Evidence computation:</strong> Directly calculates \(\mathcal{Z}\) for model comparison (Bayes factors)</li>
          <li style="margin: 0.5rem 0;"><strong>Multimodal posteriors:</strong> Naturally explores all modes without mode-hopping difficulties</li>
          <li style="margin: 0.5rem 0;"><strong>No burn-in:</strong> Every point contributes; no samples wasted</li>
          <li style="margin: 0.5rem 0;"><strong>Automatic termination:</strong> Stops when evidence is accurately determined</li>
          <li style="margin: 0.5rem 0;"><strong>Parallel-friendly:</strong> Multiple live points can be updated independently</li>
        </ul>
      </div>
      
      <div class="algorithm-box">
        <strong style="color: #dc2626;">‚úó Limitations</strong>
        <ul style="margin: 0.75rem 0 0 0; padding-left: 1.5rem;">
          <li style="margin: 0.5rem 0;"><strong>Constrained sampling challenge:</strong> Sampling from prior with \(\mathcal{L} > \mathcal{L}_{\text{min}}\) is hard</li>
          <li style="margin: 0.5rem 0;"><strong>Not ideal for posteriors alone:</strong> If you only want posterior samples, MCMC is often more efficient</li>
          <li style="margin: 0.5rem 0;"><strong>Computational cost:</strong> Can be expensive, especially with rejection sampling</li>
          <li style="margin: 0.5rem 0;"><strong>Curse of dimensionality:</strong> Rejection sampling becomes impractical in high dimensions (\(d > 20\))</li>
          <li style="margin: 0.5rem 0;"><strong>Implementation complexity:</strong> Advanced variants (MultiNest, PolyChord) are complex</li>
        </ul>
      </div>
    </div>
    
    <div class="info-note" style="margin-top: 1.5rem;">
      <strong>When to use Nested Sampling:</strong>
      <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem;">
        <li><strong>Model comparison:</strong> When you need Bayes factors or posterior odds ratios</li>
        <li><strong>Multimodal posteriors:</strong> When the posterior has multiple well-separated modes</li>
        <li><strong>Phase transitions:</strong> When the posterior has sharp features or phase transition behavior</li>
        <li><strong>Low-to-moderate dimensions:</strong> Most effective for \(d \lesssim 20\) (with basic rejection) or \(d \lesssim 100\) (with advanced methods)</li>
      </ul>
    </div>
  </div>

  <!-- COMPARISON -->
  <div class="section">
    <h2 class="section-title">Comparison: Nested Sampling vs. MCMC</h2>
    <p>
      Nested sampling and MCMC methods serve different primary purposes:
    </p>
    
    <div class="algorithm-box" style="margin-top: 1rem;">
      <strong>Key Differences:</strong>
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-top: 1rem;">
        <div><strong>Property</strong></div>
        <div><strong>MCMC (MH/HMC)</strong></div>
        <div><strong>Nested Sampling</strong></div>
        
        <div style="padding: 0.5rem 0; border-top: 1px solid #e2e8f0;">Primary goal</div>
        <div style="padding: 0.5rem 0; border-top: 1px solid #e2e8f0;">Posterior sampling</div>
        <div style="padding: 0.5rem 0; border-top: 1px solid #e2e8f0;">Evidence computation</div>
        
        <div style="padding: 0.5rem 0;">Computes \(\mathcal{Z}\)?</div>
        <div style="padding: 0.5rem 0;">No (requires thermodynamic integration)</div>
        <div style="padding: 0.5rem 0;">Yes (directly)</div>
        
        <div style="padding: 0.5rem 0;">Multimodality</div>
        <div style="padding: 0.5rem 0;">Struggles (mode-hopping hard)</div>
        <div style="padding: 0.5rem 0;">Handles naturally</div>
        
        <div style="padding: 0.5rem 0;">Burn-in needed?</div>
        <div style="padding: 0.5rem 0;">Yes</div>
        <div style="padding: 0.5rem 0;">No</div>
        
        <div style="padding: 0.5rem 0;">Parallelization</div>
        <div style="padding: 0.5rem 0;">Sequential chain</div>
        <div style="padding: 0.5rem 0;">Embarrassingly parallel</div>
        
        <div style="padding: 0.5rem 0;">Best for</div>
        <div style="padding: 0.5rem 0;">Posterior inference</div>
        <div style="padding: 0.5rem 0;">Model comparison</div>
      </div>
    </div>
    
    <div style="margin-top: 1.5rem;">
      <p>
        <strong>Practical recommendation:</strong> Use nested sampling when you need to compare models 
        (compute Bayes factors) or when the posterior is multimodal. Use HMC/NUTS for high-dimensional 
        unimodal posterior inference. Use Metropolis‚ÄìHastings when gradients aren't available and 
        dimensionality is low.
      </p>
    </div>
  </div>

  <!-- REFERENCES -->
  <div class="section">
    <h2 class="section-title">References & Further Reading</h2>
    <div style="font-size: 0.9rem; line-height: 1.8;">
      <p><strong>Nested Sampling Papers:</strong></p>
      <ul style="padding-left: 1.5rem; margin: 0.5rem 0;">
        <li>Skilling, J. (2004). "Nested Sampling." In <em>American Institute of Physics Conference Series</em>, 
        Vol. 735 (eds. R. Fischer, R. Preuss, & U. V. Toussaint), 395-405.</li>
        <li>Skilling, J. (2006). "Nested Sampling for General Bayesian Computation." 
        <em>Bayesian Analysis</em>, 1(4), 833-860.</li>
        <li>Feroz, F., Hobson, M.P., & Bridges, M. (2009). "MultiNest: An Efficient and Robust Bayesian Inference Tool 
        for Cosmology and Particle Physics." <em>Monthly Notices of the Royal Astronomical Society</em>, 398(4), 1601-1614.</li>
        <li>Speagle, J.S. (2020). "dynesty: A Dynamic Nested Sampling Package for Estimating Bayesian Posteriors and Evidences." 
        <em>Monthly Notices of the Royal Astronomical Society</em>, 493(3), 3132-3158.</li>
        <li>Ashton, G., et al. (2022). "Nested Sampling for Physical Scientists." 
        <em>Nature Reviews Methods Primers</em>, 2, 39.</li>
      </ul>
      
      <p style="margin-top: 1rem;"><strong>Importance Sampling & ESS Theory:</strong></p>
      <ul style="padding-left: 1.5rem; margin: 0.5rem 0;">
        <li>Kish, L. (1965). <em>Survey Sampling</em>. New York: Wiley. (Original ESS formula for weighted samples)</li>
        <li>Kong, A. (1992). "A Note on Importance Sampling Using Standardized Weights." 
        <em>Technical Report</em>, University of Chicago.</li>
        <li>Liu, J.S. (2001). <em>Monte Carlo Strategies in Scientific Computing</em>. New York: Springer. 
        (Chapter 2: Importance Sampling)</li>
        <li>Chopin, N., & Ridgway, J. (2017). "Leave Pima Indians Alone: Binary Regression as a Benchmark for Bayesian Computation." 
        <em>Statistical Science</em>, 32(1), 64-87. (Discussion of ESS for importance sampling)</li>
      </ul>
      
      <p style="margin-top: 1rem;"><strong>Books:</strong></p>
      <ul style="padding-left: 1.5rem; margin: 0.5rem 0;">
        <li>Sivia, D.S., & Skilling, J. (2006). <em>Data Analysis: A Bayesian Tutorial</em> (2nd ed.). Oxford University Press.</li>
        <li>Brooks, S., Gelman, A., Jones, G., & Meng, X.-L. (2011). <em>Handbook of Markov Chain Monte Carlo</em>. CRC Press.</li>
        <li>Trotta, R. (2008). "Bayes in the Sky: Bayesian Inference and Model Selection in Cosmology." 
        <em>Contemporary Physics</em>, 49(2), 71-104. (Review with nested sampling applications)</li>
      </ul>
      
      <p style="margin-top: 1rem;"><strong>Software Implementations:</strong></p>
      <ul style="padding-left: 1.5rem; margin: 0.5rem 0;">
        <li><strong>dynesty:</strong> <a href="https://dynesty.readthedocs.io/" style="color: #667eea;">dynesty.readthedocs.io</a> 
        - Pure Python, dynamic nested sampling with excellent documentation (reports ESS)</li>
        <li><strong>MultiNest:</strong> <a href="https://github.com/farhanferoz/MultiNest" style="color: #667eea;">github.com/farhanferoz/MultiNest</a> 
        - Fortran implementation with Python interface (PyMultiNest)</li>
        <li><strong>PolyChord:</strong> <a href="https://github.com/PolyChord/PolyChordLite" style="color: #667eea;">PolyChord</a> 
        - Efficient for high-dimensional problems</li>
        <li><strong>UltraNest:</strong> Modern Python implementation with advanced diagnostics</li>
      </ul>
    </div>
  </div>

</div>

  <!-- Shared utilities -->
  <script src="js/shared-utils.js"></script>

  <!-- Algorithm-specific code -->
  <script src="js/nested_sampling.js"></script>

</body>
</html>